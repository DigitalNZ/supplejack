<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>Supplejack : Install & Setup</title>
        <meta name="description" content="Documentation for the Supplejack stack">

        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/supplejack/css/syntax.css">
        <link rel="stylesheet" href="/supplejack/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class=row-fluid>
                <div id=header class=span12>
                    <h4><a class=brand href="/supplejack/">Supplejack</a>
    <small>Documentation for the Supplejack stack</small>
</h4>


                </div>
            </div>

            <div class=row-fluid>
                
                
                    <div id=navigation class=span2>
                        <ul class="nav nav-list">
    <li><a href="/supplejack/">Home</a></li>
    
        
        

        
            
                <li class=nav-header>Getting started</li>
            
            <li data-order="2"><a href="/supplejack/start/install-setup.html">Install & Setup</a></li>
        
            
            <li data-order="1"><a href="/supplejack/start/dependancies.html">Dependancies</a></li>
        
            
            <li data-order="5"><a href="/supplejack/start/supplejack-worker.html">Supplejack Worker</a></li>
        
            
            <li data-order="4"><a href="/supplejack/start/supplejack-manager.html">Supplejack Manager</a></li>
        
            
            <li data-order="3"><a href="/supplejack/start/supplejack-api.html">Supplejack API</a></li>
        
    
        
        

        
            
                <li class=nav-header>Creating your API</li>
            
            <li data-order="2"><a href="/supplejack/api/schema-dsl-domain-specific-language.html">Schema DSL (Domain Specific Language)</a></li>
        
            
            <li data-order="1"><a href="/supplejack/api/creating-a-schema.html">Creating a Schema</a></li>
        
    
        
        

        
            
                <li class=nav-header>Using the manger</li>
            
            <li data-order="1"><a href="/supplejack/manager/introduction-to-parser-scripts.html">Introduction to Parser scripts</a></li>
        
            
            <li data-order=""><a href="/supplejack/manager/parser-dsl-domain-specific-language.html">Parser DSL (Domain Specific Language)</a></li>
        
            
            <li data-order=""><a href="/supplejack/manager/validations.html">Validations</a></li>
        
            
            <li data-order=""><a href="/supplejack/manager/xml-namespaces.html">XML Namespaces</a></li>
        
            
            <li data-order=""><a href="/supplejack/manager/attribute-transformation-options.html">Attribute Transformation Options</a></li>
        
            
            <li data-order=""><a href="/supplejack/manager/enrichments.html">Enrichments</a></li>
        
            
            <li data-order=""><a href="/supplejack/manager/modifiers.html">Modifiers</a></li>
        
    
        
        

        
            
                <li class=nav-header>Developers</li>
            
            <li data-order="1"><a href="/supplejack/dev/licence.html">Licence</a></li>
        
            
            <li data-order="3"><a href="/supplejack/dev/changelog.html">Changelog</a></li>
        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class=divider></li> first to break up the content. -->
</ul>

                    </div>

                    <div id=content class=span10>
                        <div class=page-header>
    <h1>Install & Setup
        
    </h1>
</div>

<p>Once you have installed all the <a href="supplejack/start/dependancies.html">dependancies</a> you are now ready to install the rest of the stack. As all the components require configuration to interact we strongly recommend that you use the Rails Application templates that are provided for Supplejack.</p>

<h2 id="toc_0">Install the entire stack</h2>

<p>This script creates a new app using the Supplejack API and then installs and configures the Supplejack Manager and Supplejack Worker applications.</p>

<p>Once complete you will be able to access your API and harvest new data from exteranl sources. </p>

<p>To install the full stack run the following command  </p>

<h4 id="toc_1">This install template is NOT complete and will be available soon...</h4>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">rails _3.2.12_ new mysupplejack_api_name -m https://raw.github.com/digitalnz/supplejack_template/master/supplejack_template.rb
</code></pre></div>
<p>Once this is complete you do not need to run the commands below as all three components will be installed</p>

<h2 id="toc_2">Install separate components</h2>

<h3 id="toc_3">Installing the API</h3>

<p>To create a new app using the Supplejack API engine run the following command</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">rails _3.2.12_ new mysupplejack_api_name -m https://raw.github.com/digitalnz/supplejack_template/master/supplejack_api_template.rb
</code></pre></div>
<p><strong>Note:</strong> Be sure to note down the user API key that is printed to the terminal during the install process.</p>

<p>This will create a new Rails app with the Supplejack API engine configured. After running the command you will be able access http://localhost:3000/records.json?api_key=_USER-API-KEY_ in your browser to view records from your API.  </p>

<h3 id="toc_4">Installing the Supplejack Manager and Supplejack Worker</h3>

<p><strong>Prerequisites</strong> </p>

<ul>
<li>The MongoDB database is running.<br></li>
<li>Supplejack API installed and running.<br></li>
</ul>

<h5 id="toc_5">This section is NOT complete and will be updated soon...</h5>

<p>Clone the <a href="https://github.com/DigitalNZ/supplejack_manager">Supplejack Manager</a> and the <a href="https://github.com/DigitalNZ/supplejack_worker">Supplejack Worker</a> from Github. You require both applications as the Supplejack Manager creates jobs in the Supplejack Worker to process jobs in the background. </p>

<p>In simple terms, the Supplejack Manger has two purposes. 
1. Create and manage <a href="supplejack/manager/parser-dsl-domain-specific-language.html">Parsers</a>.
2. Create and mange jobs which the Supplejack Worker will process.</p>

<p>In order for the Supplejack Manager to create the jobs it requires some information about the Supplejack Worker and vice versa. This information is stored in config/application.yml. We have provided an example for your reference in each application. You will also need to update the WORKER_API_URL and HARVESTER_IPS values in your API application.yml</p>
<div class="highlight"><pre><code class="yaml language-yaml" data-lang="yaml"><span class="c1"># Example Supplejack Manager application.yml file</span>

<span class="l-Scalar-Plain">development</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">WORKER_HOST</span><span class="p-Indicator">:</span> <span class="s">&quot;http://localhost:3002&quot;</span>
  <span class="l-Scalar-Plain">WORKER_API_KEY</span><span class="p-Indicator">:</span> <span class="s">&quot;rq6umblebJqPztcefxC8sX&quot;</span>
  <span class="l-Scalar-Plain">HARVESTER_CACHING_ENABLED</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
  <span class="l-Scalar-Plain">HONEYBADGER_API_KEY</span><span class="p-Indicator">:</span> <span class="s">&quot;cd199c3f&quot;</span>
  <span class="l-Scalar-Plain">API_HOST</span><span class="p-Indicator">:</span> <span class="s">&quot;http://localhost:3000&quot;</span>
  <span class="l-Scalar-Plain">API_MONGOID_HOSTS</span><span class="p-Indicator">:</span> <span class="s">&quot;localhost:27017&quot;</span>

<span class="l-Scalar-Plain">test</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">WORKER_HOST</span><span class="p-Indicator">:</span> <span class="s">&quot;http://localhost:3002&quot;</span>
  <span class="l-Scalar-Plain">WORKER_API_KEY</span><span class="p-Indicator">:</span> <span class="s">&quot;12345&quot;</span>
  <span class="l-Scalar-Plain">HARVESTER_CACHING_ENABLED</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>
  <span class="l-Scalar-Plain">HONEYBADGER_API_KEY</span><span class="p-Indicator">:</span> <span class="s">&quot;cd199c3f&quot;</span>
  <span class="l-Scalar-Plain">API_HOST</span><span class="p-Indicator">:</span> <span class="s">&quot;http://localhost:3000&quot;</span>
  <span class="l-Scalar-Plain">API_MONGOID_HOSTS</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">localhost</span>
</code></pre></div>
<p>Once all the applications have been configured you can then run all of them locally to test harvesting. We recommend running each application on a different port to avoid conflicts.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="c"># From /path/to/api</span>
bundle <span class="nb">exec </span>rails s 

<span class="c"># From /path/to/manager</span>
bundle <span class="nb">exec </span>rails s -p 3001

<span class="c"># From /path/to/worker</span>
bundle <span class="nb">exec </span>rails s -p 3002
</code></pre></div>
<p>The final step is to run sidekiq within the worker directory you can do this by running the following command:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">bundle exec sidekiq
</code></pre></div>

                    </div>
                
            </div>

            <div class=row-fluid>
                <div id=footer class=span12>
                    Documentation for <a href="https://github.com/DigitalNZ/supplejack_api">Supplejack</a>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
    </body>
</html>
